---
title: "simulation_experiment_shared_main"
author: "Hephaes"
date: "26/08/2020"
output: html_document
---

## Loading/downloading all required packages and functions 
Assuming that 10X_main_approach3_splatter.R has been loaded to the current working directory, we load the required packages and functions by
```{r loadpackages, echo=TRUE, cache=TRUE}
library(tidyr)
library(stringr)
library(nabor)
library(aod)
library(DCATS)
library(dplyr)
library(clue)
library(gridExtra)
library(grid)
library(ggplot2)
library(lattice)
library(plotly)
library(svMisc)
library(gtools)
library(DCATS)
library(lme4)
library(scDC)
library(splatter)
library(scater)
library(Seurat)

source("10X_main_approach3_splat.r")
set.seed(1000)
```

## Generation of simulated data 

```{r generate_data, echo=TRUE, cache=TRUE}

param.groups <- newSplatParams(batchCells = 600, nGenes = 100)
sim1 <- splatSimulateGroups(param.groups, group.prob = c(1/3,1/3,1/3), de.prob = c(0.01,0.01,0.5), verbose = FALSE)
celllabels_orig <- sim1@colData@listData$Group
sim1count_mat <- counts(sim1)

```

